PS C:\Users\felip\Documents\GitHub\chat-rag-lake> & "C:/Program Files/Python311/python.exe" c:/Users/felip/Documents/GitHub/chat-rag-lake/card1_create_dummy_data.py
Generating dummy data for `1` officers and `10` consumers per officer...

Generating transactions...

        Generated `9102` transactions for portfolio `0` (officer `0`: `Leandro Moura`).

Generated `9102` transactions in total.

Dataframe info:

<class 'pandas.core.frame.DataFrame'>
RangeIndex: 9102 entries, 0 to 9101
Data columns (total 16 columns):
 #   Column              Non-Null Count  Dtype
---  ------              --------------  -----
 0   transaction_id      9102 non-null   uint32
 1   transaction_at      9102 non-null   string
 2   transaction_year    9102 non-null   uint16
 3   transaction_month   9102 non-null   uint8
 4   transaction_day     9102 non-null   uint8
 5   consumer_id_hash    9102 non-null   uint32
 6   consumer_id         9102 non-null   uint32
 7   consumer_document   9102 non-null   string
 8   consumer_name       9102 non-null   string
 9   portfolio_id        9102 non-null   uint32
 10  officer_id          9102 non-null   uint32
 11  officer_name        9102 non-null   string
 12  product             9102 non-null   category
 13  card_variant        9102 non-null   category
 14  transaction_value   9102 non-null   float64
 15  seller_description  9102 non-null   string
dtypes: category(2), float64(1), string(5), uint16(1), uint32(5), uint8(2)
memory usage: 658.2 KB
None
Dataframe size: `(9102, 16)`
Dataframe memory usage: `3.56 MB`

Prompt: Query: Qual o valor total de transações em janeiro de 2023 feitas pelos clientes da carteira do gerente Leandro Moura?
Answer: R$ 1835297.29

Prompt: Query: Quantos clientes possuem um cartão de crédito e quantos possuem um de débito?
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_tables.py:179: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  .groupby(['product']) \
Answer:
        : 10 clientes
        credit: 10 clientes
        debit: 10 clientes

Prompt: Query: Quantos clientes realizaram mais de R$ 8000 em transações com cartão platinum em um único mês?
Answer: 120 clientes

Prompt: Query: Quantas transações foram realizadas pelos 3 clientes com o maior valor total de transações em abril de 2023?
Answer: 232 transações.

Prompt: Quem são os 10 clientes que mais gastam no crédito?
Prompt: ...Eu me chamo Leandro Moura.
Answer: 
        [ID 000000005] Srta. Joana Fernandes  >  R$ 845140.19
        [ID 000000003] Brenda Pereira  >  R$ 819656.49
        [ID 000000009] Srta. Ana Beatriz Campos  >  R$ 808402.09
        [ID 000000000] Isaac da Conceição  >  R$ 793355.56
        [ID 000000001] Daniel Viana  >  R$ 775309.77
        [ID 000000006] Heitor Aragão  >  R$ 768264.74
        [ID 000000008] Davi Moura  >  R$ 733271.14
        [ID 000000007] Nicole da Luz  >  R$ 727747.45
        [ID 000000004] Kaique Cunha  >  R$ 724160.86
        [ID 000000002] Otávio Moraes  >  R$ 634314.58

Prompt: Qual é o total de gastos feito no cartão dos clientes da minha carteira?
Prompt: ...Eu me chamo Leandro Moura.
Answer: 22826262.64

Prompt: Mostre a evolução de gastos dos últimos 4 meses para 3 clientes da carteira
Answer:
        Isaac da Conceição (0):
                > 08/2023: R$ 223865.90
                > 09/2023: R$ 165332.36
                > 10/2023: R$ 202438.55
                > 11/2023: R$ 185252.47
                > 12/2023: R$ 184074.80
        Daniel Viana (1):
                > 08/2023: R$ 222760.70
                > 09/2023: R$ 190808.50
                > 10/2023: R$ 203009.09
                > 11/2023: R$ 196680.90
                > 12/2023: R$ 186789.10
        Srta. Joana Fernandes (5):
                > 08/2023: R$ 217946.49
                > 09/2023: R$ 195552.59
                > 10/2023: R$ 202996.97
                > 11/2023: R$ 168467.18
                > 12/2023: R$ 176928.26

Prompt: Mostre o ranking de gastos de cartão dos clientes por estabelecimento
Answer: 
        Cardoso: R$ 299963.83
        Moraes: R$ 242615.65
        Silva: R$ 241186.68
        Moreira: R$ 214168.14
        Farias: R$ 210486.26

Prompt: Liste quem são os clientes com gastos mensais abaixo de R$ 3000
Answer:
        Isaac da Conceição (ID 000000000)
        Daniel Viana (ID 000000001)
        Otávio Moraes (ID 000000002)
        Brenda Pereira (ID 000000003)
        Kaique Cunha (ID 000000004)
        Srta. Joana Fernandes (ID 000000005)
        Heitor Aragão (ID 000000006)
        Nicole da Luz (ID 000000007)
        Davi Moura (ID 000000008)
        Srta. Ana Beatriz Campos (ID 000000009)

Prompt: Liste os clientes das carteiras que vem reduzindo os gastos com cartão nos últimos 4 meses
Answer: 
        Isaac da Conceição (ID 000000000):
                > 08/2023: R$ 223865.90
                > 09/2023: R$ 165332.36
                > 10/2023: R$ 202438.55
                > 11/2023: R$ 185252.47
        Daniel Viana (ID 000000001):
                > 08/2023: R$ 222760.70
                > 09/2023: R$ 190808.50
                > 10/2023: R$ 203009.09
                > 11/2023: R$ 196680.90
        Otávio Moraes (ID 000000002):
                > 08/2023: R$ 231769.54
                > 09/2023: R$ 140439.40
                > 10/2023: R$ 175547.34
                > 11/2023: R$ 166912.58
        Brenda Pereira (ID 000000003):
                > 08/2023: R$ 179309.70
                > 09/2023: R$ 207243.43
                > 10/2023: R$ 215426.10
                > 11/2023: R$ 184423.87
        Srta. Joana Fernandes (ID 000000005):
                > 08/2023: R$ 217946.49
                > 09/2023: R$ 195552.59
                > 10/2023: R$ 202996.97
                > 11/2023: R$ 168467.18
        Nicole da Luz (ID 000000007):
                > 08/2023: R$ 192041.20
                > 09/2023: R$ 178539.01
                > 10/2023: R$ 230590.82
                > 11/2023: R$ 189253.06
        Davi Moura (ID 000000008):
                > 08/2023: R$ 217689.89
                > 09/2023: R$ 202633.62
                > 10/2023: R$ 176327.06
                > 11/2023: R$ 178045.24

Deleting old data from `data\landing\card_transactions.orc`...

Writing ORC files to `data\landing\card_transactions.orc`...