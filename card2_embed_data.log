PS C:\Users\felip\Documents\GitHub\chat-rag-lake> & "C:/Program Files/Python311/python.exe" c:/Users/felip/Documents/GitHub/chat-rag-lake/card2_embed_data.py
Reading ORC files from `data\landing\card_transactions.orc`...

Generating documents...
Generated 9086 documents

Generating documents...
Generated 6534 documents

Generating documents...
Generated 360 documents

Generating documents...
Generated 30 documents

Generating documents...
Generated 365 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-1-standard

Vectorstore "prj-ai-rag-llm-table-1-standard" not found, skipping deletion

Vectorstore "prj-ai-rag-llm-table-1-standard" not found, creating

Creating vectorstore prj-ai-rag-llm-table-1-standard

Found vectorstore: "prj-ai-rag-llm-table-1-standard"

Calculating embedding cost for 16388 documents using model `text-embedding-3-small`...

Total tokens: 1829843
Total documents: 16388 (~111.7 tokens/document)
Embedding cost: $0.03660

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [06:00<00:00, 10.91s/it] 


Added 16388/16388 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 16388}},
 'total_vector_count': 16388}

Generating documents...
Generated 9086 documents

Generating documents...
Generated 6534 documents

Generating documents...
Generated 360 documents

Generating documents...
Generated 30 documents

Generating documents...
Generated 365 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-2-discursive

Vectorstore "prj-ai-rag-llm-table-2-discursive" not found, skipping deletion

Vectorstore "prj-ai-rag-llm-table-2-discursive" not found, creating

Creating vectorstore prj-ai-rag-llm-table-2-discursive

Found vectorstore: "prj-ai-rag-llm-table-2-discursive"

Calculating embedding cost for 16388 documents using model `text-embedding-3-small`...

Total tokens: 1953946
Total documents: 16388 (~119.2 tokens/document)
Embedding cost: $0.03908

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [05:51<00:00, 10.66s/it] 


Added 16388/16388 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 16388}},
 'total_vector_count': 16388}

Generating documents...
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_handler.py:48: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['_page_content_body'] = ''
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_handler.py:49: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['_page_content_header'] = df.apply((lambda record: parse_content_header(record)), axis=1)
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_handler.py:50: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['_metadata'] = df[[c for c in df.columns if c not in temp_columns]] \
Generated 3004 documents

Generating documents...
Generated 2165 documents

Generating documents...
Generated 120 documents

Generating documents...
Generated 10 documents

Generating documents...
Generated 364 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-3-standard-creditcard

Vectorstore "prj-ai-rag-llm-table-3-standard-creditcard" not found, skipping deletion

Vectorstore "prj-ai-rag-llm-table-3-standard-creditcard" not found, creating

Creating vectorstore prj-ai-rag-llm-table-3-standard-creditcard

Found vectorstore: "prj-ai-rag-llm-table-3-standard-creditcard"

Calculating embedding cost for 5676 documents using model `text-embedding-3-small`...

Total tokens: 647396
Total documents: 5676 (~114.1 tokens/document)
Embedding cost: $0.01295

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [02:01<00:00, 10.11s/it] 


Added 5676/5676 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 5676}},
 'total_vector_count': 5676}

Generating documents...
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_handler.py:48: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['_page_content_body'] = ''
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_handler.py:49: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['_page_content_header'] = df.apply((lambda record: parse_content_header(record)), axis=1)
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_handler.py:50: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['_metadata'] = df[[c for c in df.columns if c not in temp_columns]] \
Generated 3004 documents

Generating documents...
Generated 2165 documents

Generating documents...
Generated 120 documents

Generating documents...
Generated 10 documents

Generating documents...
Generated 364 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-4-discursive-creditcard

Vectorstore "prj-ai-rag-llm-table-4-discursive-creditcard" not found, skipping deletion

Vectorstore "prj-ai-rag-llm-table-4-discursive-creditcard" not found, creating

Creating vectorstore prj-ai-rag-llm-table-4-discursive-creditcard

Found vectorstore: "prj-ai-rag-llm-table-4-discursive-creditcard"

Calculating embedding cost for 5676 documents using model `text-embedding-3-small`...

Total tokens: 692760
Total documents: 5676 (~122.1 tokens/document)
Embedding cost: $0.01386

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [02:03<00:00, 10.26s/it] 


Added 5676/5676 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 5676}},
 'total_vector_count': 5676}

Generating documents...
Generated 2165 documents

Generating documents...
Generated 120 documents

Generating documents...
Generated 10 documents

Generating documents...
Generated 364 documents

Generating documents...
Generated 12 documents

Generating documents...
                                _page_content_header _page_content_body                                          _metadata
0  Sumário anual de transações com cartão de créd...                     {'transaction_year': 2023, 'portfolio_id': 0, ...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-5-join-wo-transactions

Vectorstore "prj-ai-rag-llm-table-5-join-wo-transactions" not found, skipping deletion

Vectorstore "prj-ai-rag-llm-table-5-join-wo-transactions" not found, creating

Creating vectorstore prj-ai-rag-llm-table-5-join-wo-transactions

Found vectorstore: "prj-ai-rag-llm-table-5-join-wo-transactions"

Calculating embedding cost for 2672 documents using model `text-embedding-3-small`...

Total tokens: 254942
Total documents: 2672 (~95.4 tokens/document)
Embedding cost: $0.00510

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:56<00:00,  9.43s/it] 


Added 2672/2672 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 2672}},
 'total_vector_count': 2672}