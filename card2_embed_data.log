PS C:\Users\felip\Documents\GitHub\chat-rag-lake> & "C:/Program Files/Python311/python.exe" c:/Users/felip/Documents/GitHub/chat-rag-lake/card2_embed_data.py
Reading ORC files from `data\landing\card_transactions.orc`...

Generating documents...
Generated 9086 documents

Generating documents...
Generated 6534 documents

Generating documents...
Generated 360 documents

Generating documents...
Generated 30 documents

Generating documents...
Generated 365 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-1-standard

Vectorstore "prj-ai-rag-llm-table-1-standard" not found, skipping deletion

Vectorstore "prj-ai-rag-llm-table-1-standard" not found, creating

Creating vectorstore prj-ai-rag-llm-table-1-standard

Found vectorstore: "prj-ai-rag-llm-table-1-standard"

Calculating embedding cost for 16388 documents using model `text-embedding-3-small`...

Total tokens: 1829843
Total documents: 16388 (~111.7 tokens/document)
Embedding cost: $0.03660

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [06:00<00:00, 10.91s/it] 


Added 16388/16388 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 16388}},
 'total_vector_count': 16388}

Generating documents...
Generated 9086 documents

Generating documents...
Generated 6534 documents

Generating documents...
Generated 360 documents

Generating documents...
Generated 30 documents

Generating documents...
Generated 365 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-2-discursive

Vectorstore "prj-ai-rag-llm-table-2-discursive" not found, skipping deletion

Vectorstore "prj-ai-rag-llm-table-2-discursive" not found, creating

Creating vectorstore prj-ai-rag-llm-table-2-discursive

Found vectorstore: "prj-ai-rag-llm-table-2-discursive"

Calculating embedding cost for 16388 documents using model `text-embedding-3-small`...

Total tokens: 1953946
Total documents: 16388 (~119.2 tokens/document)
Embedding cost: $0.03908

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [05:51<00:00, 10.66s/it] 


Added 16388/16388 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 16388}},
 'total_vector_count': 16388}

Generating documents...
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_handler.py:48: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['_page_content_body'] = ''
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_handler.py:49: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['_page_content_header'] = df.apply((lambda record: parse_content_header(record)), axis=1)
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_handler.py:50: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['_metadata'] = df[[c for c in df.columns if c not in temp_columns]] \
Generated 3004 documents

Generating documents...
Generated 2165 documents

Generating documents...
Generated 120 documents

Generating documents...
Generated 10 documents

Generating documents...
Generated 364 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-3-standard-creditcard

Vectorstore "prj-ai-rag-llm-table-3-standard-creditcard" not found, skipping deletion

Vectorstore "prj-ai-rag-llm-table-3-standard-creditcard" not found, creating

Creating vectorstore prj-ai-rag-llm-table-3-standard-creditcard

Found vectorstore: "prj-ai-rag-llm-table-3-standard-creditcard"

Calculating embedding cost for 5676 documents using model `text-embedding-3-small`...

Total tokens: 647396
Total documents: 5676 (~114.1 tokens/document)
Embedding cost: $0.01295

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [02:01<00:00, 10.11s/it] 


Added 5676/5676 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 5676}},
 'total_vector_count': 5676}

Generating documents...
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_handler.py:48: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['_page_content_body'] = ''
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_handler.py:49: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['_page_content_header'] = df.apply((lambda record: parse_content_header(record)), axis=1)
c:\Users\felip\Documents\GitHub\chat-rag-lake\data_handler.py:50: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['_metadata'] = df[[c for c in df.columns if c not in temp_columns]] \
Generated 3004 documents

Generating documents...
Generated 2165 documents

Generating documents...
Generated 120 documents

Generating documents...
Generated 10 documents

Generating documents...
Generated 364 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-4-discursive-creditcard

Vectorstore "prj-ai-rag-llm-table-4-discursive-creditcard" not found, skipping deletion

Vectorstore "prj-ai-rag-llm-table-4-discursive-creditcard" not found, creating

Creating vectorstore prj-ai-rag-llm-table-4-discursive-creditcard

Found vectorstore: "prj-ai-rag-llm-table-4-discursive-creditcard"

Calculating embedding cost for 5676 documents using model `text-embedding-3-small`...

Total tokens: 692760
Total documents: 5676 (~122.1 tokens/document)
Embedding cost: $0.01386

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [02:03<00:00, 10.26s/it] 


Added 5676/5676 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 5676}},
 'total_vector_count': 5676}

Generating documents...
Generated 2165 documents

Generating documents...
Generated 120 documents

Generating documents...
Generated 10 documents

Generating documents...
Generated 364 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-5-join-wo-transactions

Successfully deleted vectorstore: prj-ai-rag-llm-table-5-join-wo-transactions.

Vectorstore "prj-ai-rag-llm-table-5-join-wo-transactions" not found, creating

Creating vectorstore prj-ai-rag-llm-table-5-join-wo-transactions

Found vectorstore: "prj-ai-rag-llm-table-5-join-wo-transactions"

Calculating embedding cost for 2672 documents using model `text-embedding-3-small`...

Total tokens: 246334
Total documents: 2672 (~92.2 tokens/document)
Embedding cost: $0.00493

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:54<00:00,  9.01s/it] 


Added 2672/2672 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 2672}},
 'total_vector_count': 2672}

PS C:\Users\felip\Documents\GitHub\chat-rag-lake> & "C:/Program Files/Python311/python.exe" c:/Users/felip/Documents/GitHub/chat-rag-lake/card2_embed_data.py
Reading ORC files from `data\landing\card_transactions.orc`...

Generating documents...
Generated 2165 documents

Generating documents...
Generated 120 documents

Generating documents...
Generated 10 documents

Generating documents...
Generated 364 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-5-join-wo-transactions

Successfully deleted vectorstore: prj-ai-rag-llm-table-5-join-wo-transactions.

Vectorstore "prj-ai-rag-llm-table-5-join-wo-transactions" not found, creating

Creating vectorstore prj-ai-rag-llm-table-5-join-wo-transactions

Found vectorstore: "prj-ai-rag-llm-table-5-join-wo-transactions"

Calculating embedding cost for 2672 documents using model `text-embedding-3-small`...

Total tokens: 254942
Total documents: 2672 (~95.4 tokens/document)
Embedding cost: $0.00510

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:57<00:00,  9.50s/it]


Added 2672/2672 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 2672}},
 'total_vector_count': 2672}

Generating documents...
Generated 2165 documents

Generating documents...
Generated 120 documents

Generating documents...
Generated 10 documents

Generating documents...
Generated 364 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Total de documentos original: 2672

Total de documentos: 794

page_content='Sumário diário de transações com cartão de crédito do cliente Kaique da Luz (CPF: 46159283006) no dia 1 do mês de janeiro do ano de 2023 (01/01/2023): \tR$ 4363.57 no estabelecimento "Oliveira";\nSumário diário de transações com cartão de crédito do cliente Enrico da Cruz (CPF: 97051236407) no dia 1 do mês de janeiro do ano de 2023 (01/01/2023): \tR$ 1814.17 no estabelecimento "Caldeira";\tR$ 426.61 no estabelecimento "da Mota das Neves S.A.";\nSumário diário de transações com cartão de crédito do cliente Arthur Sales (CPF: 82301674517) no dia 1 do mês de janeiro do ano de 2023 (01/01/2023): \tR$ 4669.85 no estabelecimento "da Luz";\nSumário diário de transações com cartão de crédito do cliente Lucas Viana (CPF: 92106574894) no dia 1 do mês de janeiro do ano de 2023 (01/01/2023): \tR$ 1799.38 no estabelecimento "Dias";\tR$ 2817.71 no estabelecimento "Peixoto";\tR$ 178.36 no estabelecimento "da Rosa - ME";'
908

page_content='Sumário diário de transações com cartão de crédito do cliente Carlos Eduardo Rodrigues (CPF: 80763159212) no dia 1 do mês de janeiro do ano de 2023 (01/01/2023): \tR$ 3348.86 no estabelecimento "Novaes - EI";\tR$ 2549.11 no estabelecimento "Porto";\nSumário diário de transações com cartão de crédito do cliente Ana Lívia da Cruz (CPF: 49738156084) no dia 1 do mês de janeiro do ano de 2023 (01/01/2023): \tR$ 339.93 no estabelecimento "Jesus";\nSumário diário de transações com cartão de crédito do cliente Kaique da Luz (CPF: 46159283006) no dia 2 do mês de janeiro do ano de 2023 (02/01/2023): \tR$ 4068.21 no estabelecimento "Souza Moraes S/A";\nSumário diário de transações com cartão de crédito do cliente Arthur Sales (CPF: 82301674517) no dia 2 do mês de janeiro do ano de 2023 (02/01/2023): \tR$ 1287.21 no estabelecimento "Moura - EI";'
837

page_content='Sumário diário de transações com cartão de crédito do cliente Sr. André Peixoto (CPF: 14857029332) no dia 2 do mês de janeiro do ano de 2023 (02/01/2023): \tR$ 696.27 no estabelecimento "Farias";\nSumário diário de transações com cartão de crédito do cliente Lucas Viana (CPF: 92106574894) no dia 2 do mês de janeiro do ano de 2023 (02/01/2023): \tR$ 1536.10 no estabelecimento "Caldeira";\tR$ 4487.33 no estabelecimento "Costa";\nSumário diário de transações com cartão de crédito do cliente Carlos Eduardo Rodrigues (CPF: 80763159212) no dia 2 do mês de janeiro do ano de 2023 (02/01/2023): \tR$ 2754.54 no estabelecimento "Ribeiro Ltda.";\tR$ 4870.21 no estabelecimento "Nunes - EI";\nSumário diário de transações com cartão de crédito do cliente Sra. Elisa Teixeira (CPF: 93175624855) no dia 2 do mês de janeiro do ano de 2023 (02/01/2023): \tR$ 3951.25 no estabelecimento "Azevedo Gonçalves - EI";'
893

Deleting vectorstore: prj-ai-rag-llm-table-6-chunks

Vectorstore "prj-ai-rag-llm-table-6-chunks" not found, skipping deletion

Vectorstore "prj-ai-rag-llm-table-6-chunks" not found, creating

Creating vectorstore prj-ai-rag-llm-table-6-chunks

Found vectorstore: "prj-ai-rag-llm-table-6-chunks"

Calculating embedding cost for 794 documents using model `text-embedding-3-small`...

Total tokens: 254681
Total documents: 794 (~320.8 tokens/document)
Embedding cost: $0.00509

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:21<00:00, 10.77s/it] 


Added 794/794 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 794}},
 'total_vector_count': 794}

Generating documents...
Generated 2165 documents

Generating documents...
Generated 120 documents

Generating documents...
Generated 10 documents

Generating documents...
Generated 364 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-8-storytelling

Vectorstore "prj-ai-rag-llm-table-8-storytelling" not found, skipping deletion

Vectorstore "prj-ai-rag-llm-table-8-storytelling" not found, creating

Creating vectorstore prj-ai-rag-llm-table-8-storytelling

Found vectorstore: "prj-ai-rag-llm-table-8-storytelling"

Calculating embedding cost for 2672 documents using model `text-embedding-3-small`...

Total tokens: 256977
Total documents: 2672 (~96.2 tokens/document)
Embedding cost: $0.00514

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:55<00:00,  9.19s/it] 


Added 2672/2672 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 2672}},
 'total_vector_count': 2672}

Generating documents...
Generated 2165 documents

Generating documents...
Generated 120 documents

Generating documents...
Generated 10 documents

Generating documents...
Generated 364 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-9-questions

Vectorstore "prj-ai-rag-llm-table-9-questions" not found, skipping deletion

Vectorstore "prj-ai-rag-llm-table-9-questions" not found, creating

Creating vectorstore prj-ai-rag-llm-table-9-questions

Found vectorstore: "prj-ai-rag-llm-table-9-questions"

Calculating embedding cost for 2672 documents using model `text-embedding-3-small`...

Total tokens: 293756
Total documents: 2672 (~109.9 tokens/document)
Embedding cost: $0.00588

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:57<00:00,  9.60s/it]    


Added 2672/2672 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 2672}},
 'total_vector_count': 2672}

Generating documents...
Generated 2165 documents

Generating documents...
Generated 120 documents

Generating documents...
Generated 10 documents

Generating documents...
Generated 364 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-9-questions

Successfully deleted vectorstore: prj-ai-rag-llm-table-9-questions.

Vectorstore "prj-ai-rag-llm-table-9-questions" not found, creating

Creating vectorstore prj-ai-rag-llm-table-9-questions

Found vectorstore: "prj-ai-rag-llm-table-9-questions"

Calculating embedding cost for 2672 documents using model `text-embedding-3-small`...

Total tokens: 287708
Total documents: 2672 (~107.7 tokens/document)
Embedding cost: $0.00575

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:52<00:00,  8.82s/it]


Added 2672/2672 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 2672}},
 'total_vector_count': 2672}

Generating documents...
Generated 3004 documents

Generating documents...
Generated 2165 documents

Generating documents...
Generated 120 documents

Generating documents...
Generated 10 documents

Generating documents...
Generated 364 documents

Generating documents...
Generated 12 documents

Generating documents...
Generated 1 documents

Deleting vectorstore: prj-ai-rag-llm-table-10-granularity

Successfully deleted vectorstore: prj-ai-rag-llm-table-10-granularity.

Vectorstore "prj-ai-rag-llm-table-10-granularity" not found, creating

Creating vectorstore prj-ai-rag-llm-table-10-granularity

Found vectorstore: "prj-ai-rag-llm-table-10-granularity"

Calculating embedding cost for 5676 documents using model `text-embedding-3-small`...

Total tokens: 616510
Total documents: 5676 (~108.6 tokens/document)
Embedding cost: $0.01233

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [01:52<00:00,  9.36s/it]


Added 5676/5676 documents to vectorstore

{'dimension': 1536,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 5676}},
 'total_vector_count': 5676}